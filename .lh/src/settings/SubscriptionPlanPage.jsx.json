{
    "sourceFile": "src/settings/SubscriptionPlanPage.jsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 5,
            "patches": [
                {
                    "date": 1769325073523,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1769325167107,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -66,9 +66,9 @@\n         body: JSON.stringify(requestBody),\n       });\n       navigate('/settings/subscription-plans');\n     } catch (error) {\n-      if (error.message.includes(\"tc_user_subscriptionplan' doesn't exist\")) {\n+      if (error.message.includes(\"abc\")) {\n         navigate('/settings/subscription-plans');\n       } else {\n         throw error;\n       }\n"
                },
                {
                    "date": 1769325706355,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -66,9 +66,9 @@\n         body: JSON.stringify(requestBody),\n       });\n       navigate('/settings/subscription-plans');\n     } catch (error) {\n-      if (error.message.includes(\"abc\")) {\n+      if (error.message.includes(\"tc_user_subscriptionplan' doesn't exist\")) {\n         navigate('/settings/subscription-plans');\n       } else {\n         throw error;\n       }\n"
                },
                {
                    "date": 1769326721649,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -66,9 +66,9 @@\n         body: JSON.stringify(requestBody),\n       });\n       navigate('/settings/subscription-plans');\n     } catch (error) {\n-      if (error.message.includes(\"tc_user_subscriptionplan' doesn't exist\")) {\n+      if (error.message.includes(\"\")) {\n         navigate('/settings/subscription-plans');\n       } else {\n         throw error;\n       }\n"
                },
                {
                    "date": 1769326744484,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,175 @@\n+import {\n+  Box,\n+  Button,\n+  Card,\n+  CardContent,\n+  FormControlLabel,\n+  Grid,\n+  Switch,\n+  TextField,\n+  Typography,\n+} from '@mui/material';\n+import { useState } from 'react';\n+import { useNavigate, useParams } from 'react-router-dom';\n+import { useTranslation } from '../common/components/LocalizationProvider';\n+import { useCatch, useEffectAsync } from '../reactHelper';\n+import SettingsMenu from './components/SettingsMenu';\n+import PageLayout from '../common/components/PageLayout';\n+import useSettingsStyles from './common/useSettingsStyles';\n+import fetchOrThrow from '../common/util/fetchOrThrow';\n+\n+const SubscriptionPlanPage = () => {\n+  const navigate = useNavigate();\n+  const t = useTranslation();\n+  const { classes } = useSettingsStyles();\n+\n+  const { id } = useParams();\n+\n+  const [item, setItem] = useState(null);\n+  useEffectAsync(async () => {\n+    if (id) {\n+      const response = await fetchOrThrow(`/api/subscriptionPlans/${id}`);\n+      const data = await response.json();\n+      setItem({\n+        ...data,\n+        price_value: data.price, // Map backend 'price' to frontend 'price_value'\n+      });\n+    } else {\n+      setItem({\n+        name: '',\n+        duration_days: 30,\n+        price_value: 0,\n+        active: true,\n+      });\n+    }\n+  }, [id]);\n+\n+  const handleSave = useCatch(async () => {\n+    let url = '/api/subscriptionPlans';\n+    if (id) {\n+      url += `/${id}`;\n+    }\n+\n+    // Send data in the exact format expected by the backend\n+    const requestBody = {\n+      id: item.id,\n+      name: item.name,\n+      duration_days: item.duration_days,\n+      price: item.price_value,\n+      active: item.active, // Use active from frontend state\n+    };\n+\n+    try {\n+      await fetchOrThrow(url, {\n+        method: !id ? 'POST' : 'PUT',\n+        headers: { 'Content-Type': 'application/json' },\n+        body: JSON.stringify(requestBody),\n+      });\n+      navigate('/settings/subscription-plans');\n+    } catch (error) {\n+      if (error.message.includes(\"abcd\")) {\n+        navigate('/settings/subscription-plans');\n+      } else {\n+        throw error;\n+      \n+    }\n+  });\n+\n+  const validate = () => item && item.name && item.duration_days && item.price_value !== undefined;\n+\n+  return (\n+    <PageLayout\n+      menu={<SettingsMenu />}\n+      breadcrumbs={['settingsTitle', 'settingsSubscriptionPlans', id ? 'sharedEdit' : 'sharedAdd']}\n+    >\n+      {item && (\n+        <Box sx={{ maxWidth: '800px', mx: 'auto', p: 2 }}>\n+          <Card>\n+            <CardContent>\n+              <Typography variant=\"h6\" gutterBottom>{t('sharedDetails')}</Typography>\n+              \n+              <Grid container spacing={2}>\n+                <Grid item xs={12}>\n+                  <TextField\n+                    label={t('sharedName')}\n+                    value={item.name}\n+                    onChange={(e) => setItem({ ...item, name: e.target.value })}\n+                    fullWidth\n+                    margin=\"normal\"\n+                    required\n+                  />\n+                </Grid>\n+                \n+                <Grid item xs={12} sm={6}>\n+                  <TextField\n+                    label={t('subscriptionDurationDays')}\n+                    type=\"number\"\n+                    value={item.duration_days}\n+                    onChange={(e) => setItem({ ...item, duration_days: parseInt(e.target.value) })}\n+                    fullWidth\n+                    margin=\"normal\"\n+                    required\n+                    inputProps={{ min: 1 }}\n+                  />\n+                </Grid>\n+                \n+                <Grid item xs={12} sm={6}>\n+                  <TextField\n+                    label={t('subscriptionPrice')}\n+                    type=\"number\"\n+                    value={item.price_value}\n+                    onChange={(e) => setItem({ ...item, price_value: parseFloat(e.target.value) })}\n+                    fullWidth\n+                    margin=\"normal\"\n+                    required\n+                    inputProps={{ min: 0, step: 0.01 }}\n+                  />\n+                </Grid>\n+                \n+                <Grid item xs={12}>\n+                  <FormControlLabel\n+                    control={\n+                      <Switch\n+                        checked={item.active}\n+                        onChange={(e) => setItem({ ...item, active: e.target.checked })}\n+                        sx={{\n+                          '& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track': {\n+                            backgroundColor: '#4caf50',\n+                          },\n+                          '& .MuiSwitch-switchBase:not(.Mui-checked) + .MuiSwitch-track': {\n+                            backgroundColor: '#f44336',\n+                          },\n+                        }}\n+                      />\n+                    }\n+                    label={item.active ? t('sharedActive') : t('sharedInactive')}\n+                  />\n+                </Grid>\n+              </Grid>\n+            </CardContent>\n+          </Card>\n+          \n+          <Box className={classes.buttons} sx={{ mt: 2 }}>\n+            <Button\n+              color=\"primary\"\n+              variant=\"outlined\"\n+              onClick={() => navigate(-1)}\n+            >\n+              {t('sharedCancel')}\n+            </Button>\n+            <Button\n+              color=\"primary\"\n+              variant=\"contained\"\n+              onClick={handleSave}\n+              disabled={!validate()}\n+            >\n+              {t('sharedSave')}\n+            </Button>\n+          </Box>\n+        </Box>\n+      )}\n+    </PageLayout>\n+  );\n+};\n+\n+export default SubscriptionPlanPage;\n\\ No newline at end of file\n"
                },
                {
                    "date": 1769326750240,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -66,11 +66,9 @@\n         body: JSON.stringify(requestBody),\n       });\n       navigate('/settings/subscription-plans');\n     } catch (error) {\n-      if (error.message.includes(\"abcd\")) {\n-        navigate('/settings/subscription-plans');\n-      } else {\n+      \n         throw error;\n       \n     }\n   });\n@@ -171,180 +169,5 @@\n     </PageLayout>\n   );\n };\n \n-export default SubscriptionPlanPage;\n-import {\n-  Box,\n-  Button,\n-  Card,\n-  CardContent,\n-  FormControlLabel,\n-  Grid,\n-  Switch,\n-  TextField,\n-  Typography,\n-} from '@mui/material';\n-import { useState } from 'react';\n-import { useNavigate, useParams } from 'react-router-dom';\n-import { useTranslation } from '../common/components/LocalizationProvider';\n-import { useCatch, useEffectAsync } from '../reactHelper';\n-import SettingsMenu from './components/SettingsMenu';\n-import PageLayout from '../common/components/PageLayout';\n-import useSettingsStyles from './common/useSettingsStyles';\n-import fetchOrThrow from '../common/util/fetchOrThrow';\n-\n-const SubscriptionPlanPage = () => {\n-  const navigate = useNavigate();\n-  const t = useTranslation();\n-  const { classes } = useSettingsStyles();\n-\n-  const { id } = useParams();\n-\n-  const [item, setItem] = useState(null);\n-  useEffectAsync(async () => {\n-    if (id) {\n-      const response = await fetchOrThrow(`/api/subscriptionPlans/${id}`);\n-      const data = await response.json();\n-      setItem({\n-        ...data,\n-        price_value: data.price, // Map backend 'price' to frontend 'price_value'\n-      });\n-    } else {\n-      setItem({\n-        name: '',\n-        duration_days: 30,\n-        price_value: 0,\n-        active: true,\n-      });\n-    }\n-  }, [id]);\n-\n-  const handleSave = useCatch(async () => {\n-    let url = '/api/subscriptionPlans';\n-    if (id) {\n-      url += `/${id}`;\n-    }\n-\n-    // Send data in the exact format expected by the backend\n-    const requestBody = {\n-      id: item.id,\n-      name: item.name,\n-      duration_days: item.duration_days,\n-      price: item.price_value,\n-      active: item.active, // Use active from frontend state\n-    };\n-\n-    try {\n-      await fetchOrThrow(url, {\n-        method: !id ? 'POST' : 'PUT',\n-        headers: { 'Content-Type': 'application/json' },\n-        body: JSON.stringify(requestBody),\n-      });\n-      navigate('/settings/subscription-plans');\n-    } catch (error) {\n-      if (error.message.includes(\"\")) {\n-        navigate('/settings/subscription-plans');\n-      } else {\n-        throw error;\n-      }\n-    }\n-  });\n-\n-  const validate = () => item && item.name && item.duration_days && item.price_value !== undefined;\n-\n-  return (\n-    <PageLayout\n-      menu={<SettingsMenu />}\n-      breadcrumbs={['settingsTitle', 'settingsSubscriptionPlans', id ? 'sharedEdit' : 'sharedAdd']}\n-    >\n-      {item && (\n-        <Box sx={{ maxWidth: '800px', mx: 'auto', p: 2 }}>\n-          <Card>\n-            <CardContent>\n-              <Typography variant=\"h6\" gutterBottom>{t('sharedDetails')}</Typography>\n-              \n-              <Grid container spacing={2}>\n-                <Grid item xs={12}>\n-                  <TextField\n-                    label={t('sharedName')}\n-                    value={item.name}\n-                    onChange={(e) => setItem({ ...item, name: e.target.value })}\n-                    fullWidth\n-                    margin=\"normal\"\n-                    required\n-                  />\n-                </Grid>\n-                \n-                <Grid item xs={12} sm={6}>\n-                  <TextField\n-                    label={t('subscriptionDurationDays')}\n-                    type=\"number\"\n-                    value={item.duration_days}\n-                    onChange={(e) => setItem({ ...item, duration_days: parseInt(e.target.value) })}\n-                    fullWidth\n-                    margin=\"normal\"\n-                    required\n-                    inputProps={{ min: 1 }}\n-                  />\n-                </Grid>\n-                \n-                <Grid item xs={12} sm={6}>\n-                  <TextField\n-                    label={t('subscriptionPrice')}\n-                    type=\"number\"\n-                    value={item.price_value}\n-                    onChange={(e) => setItem({ ...item, price_value: parseFloat(e.target.value) })}\n-                    fullWidth\n-                    margin=\"normal\"\n-                    required\n-                    inputProps={{ min: 0, step: 0.01 }}\n-                  />\n-                </Grid>\n-                \n-                <Grid item xs={12}>\n-                  <FormControlLabel\n-                    control={\n-                      <Switch\n-                        checked={item.active}\n-                        onChange={(e) => setItem({ ...item, active: e.target.checked })}\n-                        sx={{\n-                          '& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track': {\n-                            backgroundColor: '#4caf50',\n-                          },\n-                          '& .MuiSwitch-switchBase:not(.Mui-checked) + .MuiSwitch-track': {\n-                            backgroundColor: '#f44336',\n-                          },\n-                        }}\n-                      />\n-                    }\n-                    label={item.active ? t('sharedActive') : t('sharedInactive')}\n-                  />\n-                </Grid>\n-              </Grid>\n-            </CardContent>\n-          </Card>\n-          \n-          <Box className={classes.buttons} sx={{ mt: 2 }}>\n-            <Button\n-              color=\"primary\"\n-              variant=\"outlined\"\n-              onClick={() => navigate(-1)}\n-            >\n-              {t('sharedCancel')}\n-            </Button>\n-            <Button\n-              color=\"primary\"\n-              variant=\"contained\"\n-              onClick={handleSave}\n-              disabled={!validate()}\n-            >\n-              {t('sharedSave')}\n-            </Button>\n-          </Box>\n-        </Box>\n-      )}\n-    </PageLayout>\n-  );\n-};\n-\n export default SubscriptionPlanPage;\n\\ No newline at end of file\n"
                }
            ],
            "date": 1769325073523,
            "name": "Commit-0",
            "content": "import {\n  Box,\n  Button,\n  Card,\n  CardContent,\n  FormControlLabel,\n  Grid,\n  Switch,\n  TextField,\n  Typography,\n} from '@mui/material';\nimport { useState } from 'react';\nimport { useNavigate, useParams } from 'react-router-dom';\nimport { useTranslation } from '../common/components/LocalizationProvider';\nimport { useCatch, useEffectAsync } from '../reactHelper';\nimport SettingsMenu from './components/SettingsMenu';\nimport PageLayout from '../common/components/PageLayout';\nimport useSettingsStyles from './common/useSettingsStyles';\nimport fetchOrThrow from '../common/util/fetchOrThrow';\n\nconst SubscriptionPlanPage = () => {\n  const navigate = useNavigate();\n  const t = useTranslation();\n  const { classes } = useSettingsStyles();\n\n  const { id } = useParams();\n\n  const [item, setItem] = useState(null);\n  useEffectAsync(async () => {\n    if (id) {\n      const response = await fetchOrThrow(`/api/subscriptionPlans/${id}`);\n      const data = await response.json();\n      setItem({\n        ...data,\n        price_value: data.price, // Map backend 'price' to frontend 'price_value'\n      });\n    } else {\n      setItem({\n        name: '',\n        duration_days: 30,\n        price_value: 0,\n        active: true,\n      });\n    }\n  }, [id]);\n\n  const handleSave = useCatch(async () => {\n    let url = '/api/subscriptionPlans';\n    if (id) {\n      url += `/${id}`;\n    }\n\n    // Send data in the exact format expected by the backend\n    const requestBody = {\n      id: item.id,\n      name: item.name,\n      duration_days: item.duration_days,\n      price: item.price_value,\n      active: item.active, // Use active from frontend state\n    };\n\n    try {\n      await fetchOrThrow(url, {\n        method: !id ? 'POST' : 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(requestBody),\n      });\n      navigate('/settings/subscription-plans');\n    } catch (error) {\n      if (error.message.includes(\"tc_user_subscriptionplan' doesn't exist\")) {\n        navigate('/settings/subscription-plans');\n      } else {\n        throw error;\n      }\n    }\n  });\n\n  const validate = () => item && item.name && item.duration_days && item.price_value !== undefined;\n\n  return (\n    <PageLayout\n      menu={<SettingsMenu />}\n      breadcrumbs={['settingsTitle', 'settingsSubscriptionPlans', id ? 'sharedEdit' : 'sharedAdd']}\n    >\n      {item && (\n        <Box sx={{ maxWidth: '800px', mx: 'auto', p: 2 }}>\n          <Card>\n            <CardContent>\n              <Typography variant=\"h6\" gutterBottom>{t('sharedDetails')}</Typography>\n              \n              <Grid container spacing={2}>\n                <Grid item xs={12}>\n                  <TextField\n                    label={t('sharedName')}\n                    value={item.name}\n                    onChange={(e) => setItem({ ...item, name: e.target.value })}\n                    fullWidth\n                    margin=\"normal\"\n                    required\n                  />\n                </Grid>\n                \n                <Grid item xs={12} sm={6}>\n                  <TextField\n                    label={t('subscriptionDurationDays')}\n                    type=\"number\"\n                    value={item.duration_days}\n                    onChange={(e) => setItem({ ...item, duration_days: parseInt(e.target.value) })}\n                    fullWidth\n                    margin=\"normal\"\n                    required\n                    inputProps={{ min: 1 }}\n                  />\n                </Grid>\n                \n                <Grid item xs={12} sm={6}>\n                  <TextField\n                    label={t('subscriptionPrice')}\n                    type=\"number\"\n                    value={item.price_value}\n                    onChange={(e) => setItem({ ...item, price_value: parseFloat(e.target.value) })}\n                    fullWidth\n                    margin=\"normal\"\n                    required\n                    inputProps={{ min: 0, step: 0.01 }}\n                  />\n                </Grid>\n                \n                <Grid item xs={12}>\n                  <FormControlLabel\n                    control={\n                      <Switch\n                        checked={item.active}\n                        onChange={(e) => setItem({ ...item, active: e.target.checked })}\n                        sx={{\n                          '& .MuiSwitch-switchBase.Mui-checked + .MuiSwitch-track': {\n                            backgroundColor: '#4caf50',\n                          },\n                          '& .MuiSwitch-switchBase:not(.Mui-checked) + .MuiSwitch-track': {\n                            backgroundColor: '#f44336',\n                          },\n                        }}\n                      />\n                    }\n                    label={item.active ? t('sharedActive') : t('sharedInactive')}\n                  />\n                </Grid>\n              </Grid>\n            </CardContent>\n          </Card>\n          \n          <Box className={classes.buttons} sx={{ mt: 2 }}>\n            <Button\n              color=\"primary\"\n              variant=\"outlined\"\n              onClick={() => navigate(-1)}\n            >\n              {t('sharedCancel')}\n            </Button>\n            <Button\n              color=\"primary\"\n              variant=\"contained\"\n              onClick={handleSave}\n              disabled={!validate()}\n            >\n              {t('sharedSave')}\n            </Button>\n          </Box>\n        </Box>\n      )}\n    </PageLayout>\n  );\n};\n\nexport default SubscriptionPlanPage;"
        }
    ]
}